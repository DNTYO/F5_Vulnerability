# K03009991: iControl REST unauthenticated remote command execution vulnerability CVE-2021-22986
https://support.f5.com/csp/article/K03009991

## 概要，影響
認証されていない攻撃者が、iControl REST interfaceを使用して、Mgmt IPや Self IPを通じたネットワークアクセスにより、任意のコマンド実行やファイルの作成/削除，サービスの無効化をできる脆弱性。

この脆弱性を利用すると、システムが完全に破壊される可能性があります。

アプライアンス・モードの BIG-IP システムにも脆弱性があります。

## 影響を受ける可能性のある BIG-IPの OSバージョン

上記サイトの BIG-IP (LTM, AAM, Advanced WAF, AFM, Analytics, APM, ASM, DDHD, DNS, FPS, GTM, Link Controller, PEM, SSLO)の Versions known to be vulnerableにある OSバージョン

サポートが終了している OSバージョンについては影響を受けるかは不明

注：BIG-IP以外の F5プロダクトについては上記サイトを参照

## 対策

上記サイトの Fixes introduced inにある OSバージョンへのアップグレード

## 軽減策

上記サイトの Mitigationにある対応の実施

### Block iControl REST access through the self IP address

iControl RESTインターフェイスは、デフォルトの場合 TCP:443ポートを使用する。Port Lockdown機能で対象のポートへの接続不可とする。

注：Port Lockdown機能の設定を間違った場合、HAなどその他のサービスで使用する通信も不可となる場合がある。

### Block iControl REST access through the management interface

Mgmt IPへのアクセスを、信頼できるユーザーのみに限定し、信用できるデバイスやネットワークからのみに限定する。

## FAQ

Q1. 軽減策を実施した場合、OSのバージョンアップは不要？

A1. 軽減策はあくまでお軽減策であり、脆弱性は内在している。脆弱性は内在しているため、脆弱性をついた攻撃を受ける可能性がある。バージョンアップを不要とするかは自身のセキュリティーポリシーで判断する必要がある。

Q2. FW等により、インターネット上から BIG-IPの Mgmt IPや Self IPへの接続は許可されていない。対策は不要？

A2. インターネットからの直接のアクセスで脆弱性をついた攻撃を受ける可能性は低い。一方で、インターネットからの間接的なアクセスや内部ネットワークから脆弱性をついた攻撃を受ける可能性がある。対策，バージョンアップを不要とするかは自身のセキュリティーポリシーで判断する必要がある。

Q3. iControl REST APIの無効化は可能？

A3. 不可
